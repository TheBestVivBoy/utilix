<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Utilix â€” Home</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    :root{
      --bg:#050114;--bg-alt:#120b2c;--fg:#f5f4ff;--fg-muted:rgba(245,244,255,0.66);
      --accent:#b266f2;--accent2:#6c3ff6;--panel:rgba(17,11,35,0.84);--panel-alt:rgba(22,15,45,0.76);
      --border:rgba(255,255,255,0.08);--border-strong:rgba(255,255,255,0.16);
      --shadow-lg:0 22px 60px rgba(7,4,25,0.45);--shadow-sm:0 18px 30px rgba(9,5,27,0.32);
      --radius-lg:18px;--radius-md:12px;--radius-sm:8px;--transition:220ms ease;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:"Inter",system-ui,-apple-system,sans-serif;background:radial-gradient(circle at 20% 20%,rgba(122,68,212,0.22),transparent 45%),radial-gradient(circle at 80% 10%,rgba(178,102,242,0.18),transparent 40%),var(--bg);color:var(--fg);min-height:100vh;display:flex;flex-direction:column;position:relative;overflow-x:hidden}
    body::before{content:"";position:fixed;inset:0;background:radial-gradient(circle at 50% 0%,rgba(110,52,220,0.18),transparent 65%);pointer-events:none;z-index:0}
    a{color:inherit;text-decoration:none;transition:color var(--transition),opacity var(--transition)}
    a:hover{color:var(--accent)}
    button{font-family:inherit;border:none;background:none;color:inherit;cursor:pointer;transition:all var(--transition)}

    header{position:fixed;top:0;left:0;right:0;height:80px;padding:0 2.4rem;display:flex;align-items:center;justify-content:space-between;background:rgba(8,4,22,0.78);backdrop-filter:blur(16px);border-bottom:1px solid var(--border);box-shadow:0 12px 45px rgba(5,3,18,0.45);z-index:1200}
    .header-left{display:flex;align-items:center;gap:1.8rem}
    .logo-group{display:flex;flex-direction:column;gap:2px}
    .logo{font-size:1.45rem;font-weight:800;letter-spacing:.04em;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .logo-tagline{font-size:.75rem;text-transform:uppercase;letter-spacing:.18em;color:var(--fg-muted)}
    .header-nav ul{display:flex;gap:1rem;list-style:none;padding:.35rem .6rem;border-radius:999px;background:rgba(255,255,255,.04);border:1px solid var(--border)}
    .header-nav a{display:inline-flex;align-items:center;gap:.35rem;padding:.45rem .95rem;border-radius:999px;font-weight:600;font-size:.82rem;color:var(--fg-muted)}
    .header-nav a.active{background:linear-gradient(90deg,rgba(178,102,242,.22),rgba(108,63,246,.22));color:var(--fg);box-shadow:0 12px 30px rgba(108,63,246,.25)}
    .header-nav a:hover{color:var(--fg)}

    .auth-wrapper{display:flex;align-items:center;gap:.75rem;padding:.35rem .65rem;border-radius:999px;background:rgba(255,255,255,.05);border:1px solid var(--border)}
    .user-display{font-weight:600;font-size:.85rem}
    .logout-btn{color:#ff7b9c;font-weight:600;font-size:.85rem}
    .logout-btn:hover{opacity:.8}

    .mobile-menu-toggle{display:none;background:none;border:none;color:var(--fg);font-size:1.6rem;cursor:pointer;z-index:1300}
    .mobile-avatar{display:none;width:36px;height:36px;border-radius:50%;border:2px solid rgba(255,255,255,.2);cursor:pointer;z-index:1300}

    .sidebar{position:fixed;top:0;right:-280px;width:280px;height:100vh;background:var(--panel);border-left:1px solid var(--border);padding:2rem 1.5rem;transition:right .3s ease;z-index:1250;display:flex;flex-direction:column;gap:1.5rem;overflow-y:auto}
    .sidebar.open{right:0}
    .sidebar-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);opacity:0;visibility:hidden;transition:opacity .3s ease;z-index:1240}
    .sidebar-backdrop.show{opacity:1;visibility:visible}

    .nav-list{list-style:none;display:flex;flex-direction:column;gap:.8rem;flex:1}
    .nav-list a{display:block;padding:.8rem 1rem;border-radius:var(--radius-md);font-weight:600;color:var(--fg-muted);transition:background var(--transition)}
    .nav-list a:hover,.nav-list a.active{background:rgba(178,102,242,.25);color:var(--fg)}

    .discord-btn{padding:.55rem 1.15rem;border-radius:999px;background:linear-gradient(120deg,var(--accent),var(--accent2));color:#fff;font-weight:600;font-size:.85rem;box-shadow:0 12px 38px rgba(108,63,246,.35);text-align:center;text-decoration:none;transition:all var(--transition);position:relative;overflow:hidden}
    .discord-btn:hover{transform:translateY(-1px);box-shadow:0 15px 40px rgba(108,63,246,.4)}
    .discord-btn--ghost{background:rgba(255,255,255,.06);color:var(--fg);box-shadow:none;border:1px solid rgba(255,255,255,.08)}
    .discord-btn--ghost:hover{background:rgba(255,255,255,.12)}
    .discord-btn--login:hover::before{opacity:1}

    .canvas-wrap{position:fixed;inset:0;z-index:0;pointer-events:none}
    canvas#starfield{width:100%;height:100%;display:block}
    .page{flex:1;width:min(1180px,calc(100% - 48px));margin:0 auto;padding:140px 0 72px;display:flex;flex-direction:column;gap:2.4rem;position:relative;z-index:1}
    .hero{text-align:center;padding:3rem 2rem;background:var(--panel);border-radius:var(--radius-lg);border:1px solid var(--border);box-shadow:var(--shadow-sm);backdrop-filter:blur(12px)}
    .hero h1{font-size:3.2rem;font-weight:800;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:.5rem}
    .hero h2{font-size:1.6rem;font-weight:600;color:var(--fg);margin-bottom:1rem}

    @media(max-width:768px){
      header{padding:0 1.2rem;height:auto;flex-wrap:wrap;gap:1rem;padding-top:1rem;padding-bottom:1rem}
      .header-left{width:100%;justify-content:space-between}
      .header-nav{display:none}
      .mobile-menu-toggle,.mobile-avatar{display:block}
      .page{width:calc(100% - 32px);padding-top:140px}
    }
  </style>
</head>
<body>

<div id="loading-screen" style="position:fixed;inset:0;background:rgba(5,1,20,0.92);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:2000;gap:1.1rem;transition:opacity .45s ease;">
  <div style="width:42px;height:42px;border-radius:50%;border:4px solid rgba(255,255,255,.12);border-top-color:#b266f2;animation:spin 1s linear infinite;"></div>
  <p style="font-weight:600;color:#fff;">Loading...</p>
</div>

<header>
  <div class="header-left">
    <div class="logo-group">
      <div class="logo">Utilix</div>
      <span class="logo-tagline"></span>
    </div>
    <nav class="header-nav">
      <ul>
        <li><a href="/index" class="active">Home</a></li>
        <li><a href="/setup">Setup</a></li>
        <li><a href="/faq">FAQ</a></li>
        <li><a href="/changelog">Changelog</a></li>
      </ul>
    </nav>
  </div>

  <div class="header-right">
    <button class="mobile-menu-toggle">Menu</button>
    <img class="mobile-avatar" src="" style="display:none;">
    <div id="desktop-auth"></div>
  </div>
</header>

<nav class="sidebar">
  <ul class="nav-list">
    <li><a href="/index" class="active">Home</a></li>
    <li><a href="/setup">Setup</a></li>
    <li><a href="/faq">FAQ</a></li>
    <li><a href="/changelog">Changelog</a></li>
  </ul>
  <div id="sidebar-auth"></div>
  <a href="/login" class="discord-btn" id="sidebar-login-btn">Login with Discord</a>
</nav>
<div class="sidebar-backdrop"></div>

<div class="canvas-wrap"><canvas id="starfield"></canvas></div>

<main class="page">
  <section class="hero">
    <h1>Utilix</h1>
    <h2>Upgrade your server, elevate your community.</h2>
    <p>Utilix is the ultimate all-in-one Discord bot...</p>
    <div style="margin-top:1rem;display:flex;gap:1rem;justify-content:center;">
      <a href="https://discord.com/oauth2/authorize?client_id=1392737327125762199&permissions=8&scope=bot%20applications.commands" class="discord-btn">Invite Bot</a>
      <a href="https://discord.gg/support-server" class="discord-btn discord-btn--ghost">Join Support</a>
    </div>
  </section>
</main>

<script>
/* Starfield */
const canvas=document.getElementById('starfield'),ctx=canvas.getContext('2d');
function resize(){canvas.width=innerWidth;canvas.height=innerHeight}
addEventListener('resize',resize);resize();
const stars=Array.from({length:220},()=>({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*1.5+.5,s:Math.random()*.6+.1,color:`hsla(${Math.random()*360},70%,80%,.8)`}));
(function anim(){ctx.fillStyle='rgba(5,4,20,.3)';ctx.fillRect(0,0,canvas.width,canvas.height);stars.forEach(s=>{s.y-=s.s;if(s.y<0)s.y=canvas.height;ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,6.28);ctx.fillStyle=s.color;ctx.fill()});requestAnimationFrame(anim)})();

/* Loading remove */
document.addEventListener('DOMContentLoaded',()=>{setTimeout(()=>{document.getElementById('loading-screen').style.opacity='0';setTimeout(()=>document.getElementById('loading-screen').remove(),500)},600)});

/* Sidebar */
const toggle=document.querySelector('.mobile-menu-toggle'),avatar=document.querySelector('.mobile-avatar'),sidebar=document.querySelector('.sidebar'),backdrop=document.querySelector('.sidebar-backdrop');
toggle.onclick=()=>sidebar.classList.toggle('open');
backdrop.onclick=()=>sidebar.classList.remove('open');
avatar.onclick=()=>sidebar.classList.add('open');

/* AUTH FIXED */
async function updateAuth(){
  const desktop=document.getElementById("desktop-auth");
  const sAuth=document.getElementById("sidebar-auth");
  const sLogin=document.getElementById("sidebar-login-btn");

  try{
    const r=await fetch("/me",{credentials:"include"});
    const d=await r.json();
    if(!d.loggedIn) throw 0;

    const u=d.user;
    const av=u.avatar?`https://cdn.discordapp.com/avatars/${u.id}/${u.avatar}.${u.avatar.startsWith('a_')?'gif':'png'}?size=64`:`https://cdn.discordapp.com/embed/avatars/${u.discriminator%5}.png`;
    const name=`${u.username}#${u.discriminator}`;

    desktop.innerHTML=`
      <a href="/dashboard" class="discord-btn discord-btn--ghost">Dashboard</a>
      <div class="auth-wrapper">
        <img src="${av}" style="width:40px;height:40px;border-radius:50%;border:2px solid rgba(255,255,255,.2)">
        <span class="user-display">${name}</span>
        <a href="/logout" class="logout-btn">Logout</a>
      </div>`;

    avatar.src=av;avatar.style.display="block";

    sAuth.innerHTML=`
      <div class="auth-wrapper">
        <img src="${av}" style="width:36px;height:36px;border-radius:50%">
        <span class="user-display">${name}</span>
        <a href="/logout" class="logout-btn">Logout</a>
      </div>
      <a href="/dashboard" class="discord-btn" style="margin-top:.5rem;width:100%">Dashboard</a>
    `;

    sLogin.style.display="none";

  } catch {
    desktop.innerHTML=`<a href="/login" class="discord-btn discord-btn--login">Login with Discord</a>`;
    avatar.style.display="none";
    sAuth.innerHTML="";
    sLogin.style.display="block";
  }
}
updateAuth();
</script>
</body>
</html>
